(()=>{var S=document.getElementById("gameCanvas"),_=S.height*4,b=S.width*4,N=S.width,R=S.height,s=S.getContext("2d"),P=document.getElementById("stats"),G=document.getElementById("radarCanvas"),w=G.getContext("2d");var st=400,nt=180,ot=5,ht=2e3,U=150,$=300,H=350,V=0,at=["#FF0000","#90EE90","#0000FF","#FFFF00","#FFA500","#800080","#00FFFF","#FF69B4","#FFD700","#ADFF2F","#FF4500","#1E90FF"],K=["Slitherin","Viper","Cobra","Python","Anaconda","Mamba","Asp","Rattler","Boa","Serpent","Sidewinder","Boomslang","Racer","Kingsnake","Coral","Cottonmouth","Copperhead","Harlequin","Gaboon","Moccasin"],Z=["#FF69B4","#FFD700","#00FF00","#00FFFF","#FF00FF","#ADFF2F","#FFA500","#FFB6C1","#FFFF00","#00CED1","#90EE90","#FF7F50","#FF6347","#7CFC00","#AFEEEE","#F0E68C","#FFFAFA","#DA70D6","#DB7093","#FFC0CB","#FFEFD5","#FFA07A","#98FB98","#FFB347","#FFFFE0"],v={turningSpeed:.15,turningSpeedMultiplier:1,directionSmoothing:.2,minSegmentDistance:2,maxSegmentDistance:2.8,smoothingStrength:.25,damping:.8,turnTighteningFactor:.3,maxBendAngle:45,segmentSpacing:2.5},W=class{static isNameTaken(t,i){return i.some(e=>e.name===t&&e.isAlive&&!e.isDying)}constructor(t,i,e,n=!1,h="Player"){this.color=e,this.isBot=n,this.name=h,this.SAFE_SPAWN_DISTANCE=80,this.RESPAWN_TIME=180,this.MIN_SEGMENT_SIZE=1.5,this.BASE_LENGTH=50,this.MAX_LENGTH=Math.floor(this.BASE_LENGTH*7.5),this.GROWTH_RATE=.02,this.SPEED_BOOST_COST=2,this.BASE_SPEED=160,this.SPEED_BOOST=1.5,this.x=t,this.y=i,this.segments=[],n&&this.reset(t,i),this.size=6,this.lives=3,this.isAlive=!0,this.respawnTimer=0,this.targetPoint=null,this.opacity=1,this.isDying=!1,this.deathProgress=0,this.foodEaten=0,this.baseSpeed=this.BASE_SPEED,this.speed=this.baseSpeed,this.speedBoost=1.5,this.isSpeedingUp=!1,this.speedBoostCost=2,this.lastSpeedBoostTime=0,this.lastLengthChangeTime=0,this.cursorX=0,this.cursorY=0,this.trail=[],this.targetDirection={...this.direction},this.turningSpeed=v.turningSpeed,this.turningSpeedMultiplier=v.turningSpeedMultiplier,this.directionSmoothing=v.directionSmoothing,this.minSegmentDistance=v.minSegmentDistance,this.maxSegmentDistance=v.maxSegmentDistance,this.smoothingStrength=v.smoothingStrength,this.damping=v.damping,this.turnTighteningFactor=v.turnTighteningFactor,this.maxBendAngle=v.maxBendAngle,this.segmentSpacing=v.segmentSpacing}reset(t,i){this.x=t,this.y=i,this.segments=[],this.segments.push({x:t,y:i});let e=Math.random()*2*Math.PI;this.direction={x:Math.cos(e),y:Math.sin(e)},this.targetDirection={...this.direction},this.isAlive=!0,this.opacity=1,this.isDying=!1,this.deathProgress=0}getCurrentMaxLength(){let t=this.MAX_LENGTH-this.BASE_LENGTH,i=Math.min(t*this.foodEaten*this.GROWTH_RATE,t);return Math.floor(this.BASE_LENGTH+i)}grow(t){let e=1/Math.sqrt(this.segments.length),n=t*.1*e;this.foodEaten+=n;let h={...this.segments[this.segments.length-1]};this.segments.push(h)}update(t,i,e){this.updatedScale=this.segments.length>$?2.4:this.segments.length>U?2:1.6;let n=this.getCurrentMaxLength();if(this.isSpeedingUp){if(this.segments.length<=this.BASE_LENGTH){this.isSpeedingUp=!1,this.speed=this.baseSpeed;return}let f=Date.now();if(this.lastShrinkTime||(this.lastShrinkTime=f),f-this.lastShrinkTime>=200){if(this.segments.length>this.BASE_LENGTH){let u=this.segments.pop();if(u){let F=u.x+(Math.random()-.5)*10,D=u.y+(Math.random()-.5)*10,A=new L;A.position={x:F,y:D},t.push(A),this.foodEaten=Math.max(0,this.foodEaten-.2)}}else this.isSpeedingUp=!1;this.lastShrinkTime=f}this.speed=this.baseSpeed*this.SPEED_BOOST}else this.lastShrinkTime=null,this.speed=this.baseSpeed;if(this.isDying){this.deathProgress+=.02,this.opacity=Math.max(0,1-this.deathProgress),this.deathProgress>=1&&(this.isDying=!1,this.isAlive=!1,this.lives>0&&(this.respawnTimer=this.RESPAWN_TIME));return}if(!this.isAlive){if(this.lives<=0)return;this.respawnTimer--,this.respawnTimer<=0&&this.respawn();return}this.isBot&&this.updateAI(t,i);let h=Math.atan2(this.direction.y,this.direction.x)*180/Math.PI,a=Math.atan2(this.targetDirection.y,this.targetDirection.x)*180/Math.PI,r=lt(h,a,this.turningSpeed*e*this.turningSpeedMultiplier);this.direction.x=Math.cos(r*Math.PI/180),this.direction.y=Math.sin(r*Math.PI/180);let l=Math.sqrt(this.direction.x*this.direction.x+this.direction.y*this.direction.y);if(l===0?this.direction={x:1,y:0}:(this.direction.x/=l,this.direction.y/=l),this.targetDirection){let f=this.directionSmoothing,y=Math.atan2(this.direction.y,this.direction.x),M=Math.atan2(this.targetDirection.y,this.targetDirection.x)-y;for(;M>Math.PI;)M-=Math.PI*2;for(;M<-Math.PI;)M+=Math.PI*2;let F=y+M*f;this.direction.x=Math.cos(F),this.direction.y=Math.sin(F)}let c=this.segments[0],g=this.speed*e,d={x:c.x+this.direction.x*g,y:c.y+this.direction.y*g};this.segments.unshift(d),this.applySegmentSmoothing(e),this.isSpeedingUp?this.trail.push({x:d.x,y:d.y}):this.trail=[];for(let f=1;f<this.segments.length;f++){let y=this.segments[f-1],u=this.segments[f],M=y.x-u.x,F=y.y-u.y,D=Math.sqrt(M*M+F*F),A=Math.abs(this.targetDirection.x-this.direction.x)+Math.abs(this.targetDirection.y-this.direction.y),O=this.size*(3-this.turnTighteningFactor*A);if(D>O){let x=this.size*(1.5+A)/D;u.x=y.x-M*x,u.y=y.y-F*x}}for(;this.segments.length>n;)this.segments.pop()}applySegmentSmoothing(t){let i=this.size*this.minSegmentDistance,e=this.size*this.maxSegmentDistance,n=this.smoothingStrength;for(let h=1;h<this.segments.length;h++){let a=this.segments[h-1],r=this.segments[h],l=a.x-r.x,c=a.y-r.y,g=Math.sqrt(l*l+c*c);if(g<i)continue;let d=l/g,f=c/g,y=i,u=Math.abs(this.targetDirection.x-this.direction.x+this.targetDirection.y-this.direction.y);y-=u*this.size*.3;let M=a.x-d*y,F=a.y-f*y;r.vx||(r.vx=0),r.vy||(r.vy=0);let D=Math.min(g/e,1),A=n*(1+D);r.vx+=(M-r.x)*A,r.vy+=(F-r.y)*A;let O=this.damping;r.vx*=O,r.vy*=O,r.x+=r.vx*t,r.y+=r.vy*t,g>e&&(r.x=a.x-d*e,r.y=a.y-f*e,r.vx=0,r.vy=0)}}calculateBendAngle(t){let i=this.segments[t-1],e=this.segments[t],n=e.x-i.x,h=e.y-i.y;return Math.atan2(h,n)*(180/Math.PI)}applyBend(t,i){let e=Math.min(Math.max(i,-this.maxBendAngle),this.maxBendAngle);t.x+=Math.cos(e*Math.PI/180)*this.size*.05,t.y+=Math.sin(e*Math.PI/180)*this.size*.05}canSpeedBoost(){return this.segments.length>this.BASE_LENGTH}updateAI(t,i){let e=this.segments[0],n=50,h=200,a=300,r=.85,l=this.direction.x,c=this.direction.y,g=null,d=h,f=null,y=a,u=null,M=n;if(i.forEach(x=>{if(x!==this&&x.isAlive&&!x.isDying){let B=x.segments[0],C=B.x-e.x,z=B.y-e.y,T=Math.sqrt(C*C+z*z),Y=x.segments.length/this.segments.length;if(Y>1.2&&T<n*1.5?T<M&&(M=T,u=x):Y<r&&T<a&&T<y&&(y=T,f=x),T<n){let k=1-T/n;l-=C/T*k*2,c-=z/T*k*2}}}),t.forEach(x=>{let B=x.position.x-e.x,C=x.position.y-e.y,z=Math.sqrt(B*B+C*C);z<d&&(d=z,g=x)}),u){let x=e.x-u.segments[0].x,B=e.y-u.segments[0].y,C=Math.sqrt(x*x+B*B);l=x/C,c=B/C}else if(f&&Math.random()<.7)l=(f.segments[0].x-e.x)/y,c=(f.segments[0].y-e.y)/y;else if(g)l=(g.position.x-e.x)/d,c=(g.position.y-e.y)/d;else{let x=Date.now()*.001;l=Math.cos(x*.5),c=Math.sin(x*.7)}let F=Math.sqrt(l*l+c*c),D={x:0,y:0};F>0&&(D={x:l/F,y:c/F});let A=.1;this.direction.x=this.direction.x*(1-A)+D.x*A,this.direction.y=this.direction.y*(1-A)+D.y*A;let O=Math.sqrt(this.direction.x*this.direction.x+this.direction.y*this.direction.y);this.direction.x/=O,this.direction.y/=O}getDistance(t,i){let e=t.x-i.x,n=t.y-i.y;return Math.sqrt(e*e+n*n)}respawn(){if(this.lives>0){let t=this.findSafeSpawnPosition();this.reset(t.x,t.y),this.targetPoint=null}}findSafeSpawnPosition(){let i=this.SAFE_SPAWN_DISTANCE*this.SAFE_SPAWN_DISTANCE;for(let e=0;e<20;e++){let n=Math.floor(Math.random()*(b-2*H))+H,h=Math.floor(Math.random()*(_-2*H))+H;if(!this.isPositionNearSnakes(n,h,i))return{x:n,y:h}}return{x:b/2,y:_/2}}isPositionNearSnakes(t,i,e){if(E.length===0)return!1;for(let n of E){if(n===this||!n.isAlive||n.isDying)continue;let h=t-n.segments[0].x,a=i-n.segments[0].y;if(h*h+a*a<e)return!0}return!1}draw(){if(!this.isAlive&&!this.isDying)return;let t=1.6,i=1;if(this.segments.length>$?i=2.4/t:this.segments.length>U&&(i=2/t),s.globalAlpha=this.opacity,this.isSpeedingUp)for(let a=0;a<this.segments.length;a++){let r=this.segments[a],l=r.x-p.x,c=r.y-p.y;if(l>=-10&&l<=N+10&&c>=-10&&c<=R+10){let g=(a+1)/this.trail.length*.7,d=g*.5;s.fillStyle=`rgba(255, 215, 0, ${d})`,s.shadowColor="yellow",s.shadowBlur=10*i,s.beginPath();let f=Math.max(0,this.size*(1.6-a/this.trail.length/3))*t*i;s.arc(l,c,f,0,Math.PI*2),s.fill(),s.shadowColor="transparent",s.shadowBlur=0,s.fillStyle=`rgba(255, 170, 0, ${g})`,s.beginPath();let y=Math.max(0,this.size*(1.4-a/this.trail.length/3))*t*i;s.arc(l,c,y,0,Math.PI*2),s.fill()}}s.fillStyle=this.color;for(let a=this.segments.length-1;a>=0;a--){let r=this.segments[a],l=r.x-p.x,c=r.y-p.y;if(l>=-10&&l<=N+10&&c>=-10&&c<=R+10){let d=this.size*this.updatedScale;if(a===0){let f=this.direction.x*this.targetDirection.x+this.direction.y*this.targetDirection.y,y=Math.max(.3,f);d*=y}s.beginPath(),s.arc(l,c,d,0,Math.PI*2),s.fill()}}let e=this.segments[0],n=e.x-p.x,h=e.y-p.y;if(n>=-10&&n<=N+10&&h>=-10&&h<=R+10){let a=this.updatedScale/t,r=this.updatedScale/t;s.fillStyle="white";let l=2*t*a,c=1.5*t*a,g=this.direction.x*l,d=this.direction.y*l;s.beginPath(),s.arc(n+g-d,h+d+g,c,0,Math.PI*2),s.arc(n+g+d,h+d-g,c,0,Math.PI*2),s.fill();let f=.9*r,y=c*.8,u=this.targetDirection.x*f,M=this.targetDirection.y*f,F=this.targetDirection.x*f,D=this.targetDirection.y*f;s.fillStyle="black",s.beginPath(),s.arc(n+g-d+u,h+d+g+M,y,0,Math.PI*2),s.arc(n+g+d+F,h+d-g+D,y,0,Math.PI*2),s.fill(),s.fillStyle="rgba(250, 250, 250, 0.6)",s.font=`bold ${12*t}px Arial`,s.textAlign="center",s.textBaseline="bottom";let A=this.size*Math.max(1-0/this.segments.length,this.MIN_SEGMENT_SIZE)*t+5;s.fillText(this.name,n,h-A)}s.globalAlpha=1}},L=class{constructor(t=!1){this.size=t?8:4,this.value=t?3:1,this.isFlying=t,this.resetPosition(),this.color=this.isFlying?"gold":"lightgreen",this.shadowColor=this.isFlying?"rgba(255, 215, 0, 0.3)":"rgba(144, 238, 144, 0.3)",this.floatingSpeed=.01,this.floatingAmplitude=.8,this.isFlying&&(this.blinkInterval=500,this.lastBlink=0,this.isFlickering=!1,this.fleeingBlinkInterval=300,this.fleeingLastBlink=0,this.isFleeingFlickering=!1,this.setRandomDirection(),this.baseSpeed=1,this.speed=this.baseSpeed*1.3,this.wobbleInterval=150,this.lastWobble=Date.now(),this.maxWanderDistance=150,this.initialPosition={...this.position})}setRandomDirection(){this.direction={x:Math.random()-.5,y:Math.random()-.5};let t=Math.sqrt(this.direction.x*this.direction.x+this.direction.y*this.direction.y);this.direction.x/=t,this.direction.y/=t}resetPosition(){this.position={x:Math.random()*(b-100)+50,y:Math.random()*(_-100)+50}}update(){if(this.isFlying){if(!this.fleeing){let i=Date.now();i-this.lastWobble>this.wobbleInterval&&(this.setRandomDirection(),this.lastWobble=i)}if(this.position.x+=this.direction.x*this.speed,this.position.y+=this.direction.y*this.speed,this.position.x<0&&(this.position.x=b),this.position.x>b&&(this.position.x=0),this.position.y<0&&(this.position.y=_),this.position.y>_&&(this.position.y=0),this.getDistance(this.initialPosition,this.position)>this.maxWanderDistance){let i=this.initialPosition.x-this.position.x,e=this.initialPosition.y-this.position.y,n=Math.sqrt(i*i+e*e);this.direction.x=i/n,this.direction.y=e/n,this.speed=this.baseSpeed}else this.speed=this.baseSpeed*1.3}}getDistance(t,i){let e=t.x-i.x,n=t.y-i.y;return Math.sqrt(e*e+n*n)}flee(t,i){if(this.isFlying&&!this.fleeing){let e=this.position.x-t.x,n=this.position.y-t.y,h=Math.sqrt(e*e+n*n);if(h<70){let a={x:e/h,y:n/h};this.direction=a,this.speed=this.baseSpeed*8,this.fleeing=!0,this.fleeingColor="yellow",this.size=12,setTimeout(()=>{this.speed=this.baseSpeed*1.3,this.fleeing=!1,this.fleeingColor="red",this.size=9},Math.random()*1500+500)}}}draw(){let t=0;if(!this.isFlying){let n=Date.now()*this.floatingSpeed;t=Math.sin(n+this.position.y)*this.floatingAmplitude}let i=this.position.x-p.x,e=this.position.y-p.y+t;if(i>=-10&&i<=N+10&&e>=-10&&e<=R+10&&(this.isFlying||(s.shadowColor="white",s.shadowBlur=32,s.fillStyle="white",s.globalAlpha=.8,s.beginPath(),s.arc(i,e,this.size*.8,0,Math.PI*2),s.fill(),s.globalAlpha=1,s.shadowColor="transparent",s.shadowBlur=0,s.shadowColor=this.shadowColor,s.shadowBlur=64,s.globalAlpha=.5,s.fillStyle=this.color,s.beginPath(),s.arc(i,e,this.size*1.2,0,Math.PI*2),s.fill(),s.globalAlpha=1,s.shadowColor="transparent",s.shadowBlur=0,s.fillStyle=this.color,s.globalAlpha=.9,s.beginPath(),s.arc(i,e,this.size,0,Math.PI*2),s.fill(),s.globalAlpha=1),s.fillStyle=this.color,s.beginPath(),s.arc(i,e,this.size,0,Math.PI*2),s.fill(),this.isFlying)){let n=this.blinkInterval,h=this.isFleeingFlickering?this.isFleeingFlickering:this.isFlickering,a=this.fleeingLastBlink||this.lastBlink,r=this.fleeing?1.4:1.2,l=Date.now();l-a>=n&&(this.fleeing?(this.isFleeingFlickering=!this.isFleeingFlickering,this.fleeingLastBlink=l):(this.isFlickering=!this.isFlickering,this.lastBlink=l)),h&&(s.fillStyle=this.shadowColor,s.beginPath(),s.arc(i,e,this.size*r,0,Math.PI*2),s.fill())}}};function rt(){return Z[Math.floor(Math.random()*Z.length)]}function j(o,t,i){return o+(t-o)*i}function lt(o,t,i){let e=(t-o+360)%360;return e>180&&(e-=360),o+e*i}var p={x:0,y:0,update:function(o,t){let e=o-N/2,n=t-R/2;this.x+=(e-this.x)*.1,this.y+=(n-this.y)*.1}};function et(o,t,i,e){let n;do n=K[Math.floor(Math.random()*K.length)];while(W.isNameTaken(n,e));let h=Math.random()*b,a=Math.random()*_;return new W(h,a,i,!0,n)}var X=[],E=[],m=new W(S.width/2,S.height/2,"#4444ff",!1,"Player");E.push(m);var Q=m.findSafeSpawnPosition();m.reset(Q.x,Q.y);for(let o=0;o<ot;o++){let t=et(Math.random()*S.width,Math.random()*S.height,rt(),E);X.push(t),E.push(t)}var I=Array(nt).fill(null).map(()=>new L),ct=9e3;setInterval(()=>{Math.random()<.2&&I.push(new L(!0))},ct);document.addEventListener("mousemove",o=>{if(!m.isAlive||m.isDying)return;let t=o.clientX-S.offsetLeft+p.x,i=o.clientY-S.offsetTop+p.y,e=m.segments[0],n=t-e.x,h=i-e.y,a={x:n,y:h},r=Math.sqrt(a.x*a.x+a.y*a.y);r>0?(a.x/=r,a.y/=r):a={x:1,y:0};let l=.5;m.targetDirection.x=j(m.targetDirection.x,a.x,l),m.targetDirection.y=j(m.targetDirection.y,a.y,l)});document.addEventListener("keydown",o=>{o.code==="Space"&&m.isAlive&&m.canSpeedBoost()&&(m.isSpeedingUp=!0,m.lastSpeedBoostTime=Date.now())});document.addEventListener("keyup",o=>{o.code==="Space"&&(m.isSpeedingUp=!1)});document.addEventListener("mousedown",o=>{o.button===0&&m.isAlive&&m.canSpeedBoost()&&(m.isSpeedingUp=!0)});document.addEventListener("mouseup",o=>{o.button===0&&(m.isSpeedingUp=!1)});function gt(o){let t=null,i=1/0,e=J(o);return at.forEach(n=>{let h=J(n),a=dt(e,h);a<i&&(i=a,t=n)}),t}function J(o){let t=parseInt(o.slice(1,3),16),i=parseInt(o.slice(3,5),16),e=parseInt(o.slice(5,7),16);return{r:t,g:i,b:e}}function dt(o,t){return Math.sqrt(.3*Math.pow(o.r-t.r,2)+.59*Math.pow(o.g-t.g,2)+.11*Math.pow(o.b-t.b,2))}function ft(){E.forEach(o=>{if(!o.isAlive||o.isDying)return;let t=o.segments[0];if(t.x<=0||t.x>=b||t.y<=0||t.y>=_){tt(o);return}let i=o.direction;for(let e=I.length-1;e>=0;e--){let n=I[e];n.isFlying&&!n.fleeing&&n.flee(t,i);let h=t.x-n.position.x,a=t.y-n.position.y;if(Math.sqrt(h*h+a*a)<o.size+n.size){I.splice(e,1);let l=Math.random()<.1,c=Date.now();I.length<st&&c-V>=ht&&(I.push(new L(l)),V=c),o.segments.length<o.MAX_LENGTH&&o.grow(n.value),o.foodEaten+=n.value*.2;break}}});for(let o=0;o<E.length;o++){let t=E[o];if(!t.isAlive||t.isDying)continue;let i=t.segments[0];for(let e=0;e<E.length;e++){let n=E[e];if(!(t===n||!n.isAlive||n.isDying))for(let h=0;h<n.segments.length;h++){let a=n.segments[h],r=i.x-a.x,l=i.y-a.y,c=Math.sqrt(r*r+l*l),g=h===0?n.size:n.size*.8;if(c<t.size+g*.7){tt(t);return}}}}}function tt(o){if(o.lives=Math.max(0,o.lives-1),o.isDying=!0,o.deathProgress=0,o.lives<=0){let t=[...o.segments],i=2.5,e=gt(o.color);t.forEach(a=>{let r=Math.random()*2*Math.PI,l=Math.random()*o.size*i,c=a.x+l*Math.cos(r),g=a.y+l*Math.sin(r),d=new L;d.color=e,d.position={x:c,y:g},I.push(d)});let n=X.indexOf(o);n!==-1&&X.splice(n,1);let h=E.indexOf(o);if(h!==-1&&E.splice(h,1),o.isBot){let a=Math.random()*S.width,r=Math.random()*S.height,l=et(a,r,mt(),E);E.push(l),X.push(l)}}else console.log(`${o.name} lost a life! Remaining lives: ${o.lives}`)}function mt(){let o=Math.floor(Math.random()*256),t=Math.floor(Math.random()*256),i=Math.floor(Math.random()*256);return`rgb(${o}, ${t}, ${i})`}function yt(){P.innerHTML=E.map(t=>{let i="";return t.isAlive&&!t.isDying?i='<span class="active-indicator"></span>':t.lives>0&&(i='<span class="respawning-indicator">|</span>'),`
                <div class="player-stats">
                    <strong>${t.name}</strong>: 
                    ${t.lives} ${t.lives===1?"life":"lives"} | 
                    ${t.segments.length}/${t.getCurrentMaxLength()} |
                    ${i} 
                </div>
            `}).join(""),document.querySelectorAll(".respawning-indicator").forEach(t=>{let i=0,e=setInterval(()=>{i+=5,t.style.transform=`rotate(${i}deg)`,i>=360&&(i=0)},20)}),P.style.position="absolute",P.style.top="56px",P.style.left="1040px",P.style.color="white",P.style.fontSize="12px",P.style.fontFamily="sans-serif",P.style.pointerEvents="none",P.style.zIndex="100",P.style.opacity="10"}function pt(){w.clearRect(0,0,G.width,G.height);let o=Math.min(G.width/b,G.height/_);I.forEach(r=>{let l=r.position.x*o,c=r.position.y*o;w.fillStyle=r.isFlying?"gold":"lightgreen",w.beginPath(),w.arc(l,c,2,0,Math.PI*2),w.fill()});let t=m.segments[0].x*o,i=m.segments[0].y*o;w.fillStyle=m.color,w.beginPath(),w.arc(t,i,4,0,Math.PI*2),w.fill();let e=p.x*o,n=p.y*o,h=N*o,a=R*o;w.strokeStyle="white",w.lineWidth=1,w.strokeRect(e,n,h,a)}function xt(o){yt();let t=[...E];m.isAlive&&p.update(m.segments[0].x,m.segments[0].y),s.clearRect(0,0,N,R),s.strokeStyle="#FF4444",s.lineWidth=4,s.strokeRect(-p.x,-p.y,b,_),s.strokeStyle="#333333",s.lineWidth=1;let i=100,e=Math.floor(p.x/i)*i,n=Math.floor(p.y/i)*i;for(let h=e;h<p.x+N+i;h+=i)h>=0&&h<=b&&(s.beginPath(),s.moveTo(h-p.x,0),s.lineTo(h-p.x,R),s.stroke());for(let h=n;h<p.y+R+i;h+=i)h>=0&&h<=_&&(s.beginPath(),s.moveTo(0,h-p.y),s.lineTo(N,h-p.y),s.stroke());I.forEach(h=>{h.update(),h.draw()}),t.forEach(h=>{h.update(I,t,o),h.draw()}),ft()}var it=performance.now();function q(){s.clearRect(0,0,S.width,S.height),pt();let o=performance.now(),t=(o-it)/1e3;t=Math.min(t,1/30),xt(t),m.lives<=0?(s.fillStyle="rgba(0, 0, 0, 0.5)",s.fillRect(0,0,S.width,S.height),s.fillStyle="white",s.font="30px Arial",s.textAlign="center",s.textBaseline="middle",s.fillText("Game Over!",S.width/2,S.height/2),cancelAnimationFrame(q)):(it=o,requestAnimationFrame(q))}q();})();
